<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>图嵌入之node2vec（KDD-2016） | 郭必扬的写字楼</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-alpha/dist/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/logo_no_words.png">
    <script>
    var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?5aca48f844181444aea941eb9d707584";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
    </script>
    <meta name="description" content="欢迎光临写字楼，大楼尚在施工中🚧，对您造成的不便请您谅解">
    
    <link rel="preload" href="/assets/css/0.styles.29dce6f0.css" as="style"><link rel="preload" href="/assets/js/app.41fc4255.js" as="script"><link rel="preload" href="/assets/js/2.a266bdc2.js" as="script"><link rel="preload" href="/assets/js/96.0b640400.js" as="script"><link rel="prefetch" href="/assets/js/10.4ee4705c.js"><link rel="prefetch" href="/assets/js/100.29306973.js"><link rel="prefetch" href="/assets/js/101.b7851f01.js"><link rel="prefetch" href="/assets/js/102.969e84bd.js"><link rel="prefetch" href="/assets/js/103.a356b143.js"><link rel="prefetch" href="/assets/js/104.51024b34.js"><link rel="prefetch" href="/assets/js/105.43f26204.js"><link rel="prefetch" href="/assets/js/106.c52df18d.js"><link rel="prefetch" href="/assets/js/107.856c79a2.js"><link rel="prefetch" href="/assets/js/108.bfb45b71.js"><link rel="prefetch" href="/assets/js/11.e2907ec5.js"><link rel="prefetch" href="/assets/js/12.65ea25ed.js"><link rel="prefetch" href="/assets/js/13.cbd5d07c.js"><link rel="prefetch" href="/assets/js/14.b84744eb.js"><link rel="prefetch" href="/assets/js/15.aadcc6a8.js"><link rel="prefetch" href="/assets/js/16.db45b326.js"><link rel="prefetch" href="/assets/js/17.7b58bd1b.js"><link rel="prefetch" href="/assets/js/18.38d69ee8.js"><link rel="prefetch" href="/assets/js/19.4e5ae4a8.js"><link rel="prefetch" href="/assets/js/20.7095c920.js"><link rel="prefetch" href="/assets/js/21.242fa291.js"><link rel="prefetch" href="/assets/js/22.5d8fafb1.js"><link rel="prefetch" href="/assets/js/23.7ce40eb4.js"><link rel="prefetch" href="/assets/js/24.18bba9ed.js"><link rel="prefetch" href="/assets/js/25.5d7dc814.js"><link rel="prefetch" href="/assets/js/26.a658bfa8.js"><link rel="prefetch" href="/assets/js/27.67a75243.js"><link rel="prefetch" href="/assets/js/28.f618d912.js"><link rel="prefetch" href="/assets/js/29.cebd6470.js"><link rel="prefetch" href="/assets/js/3.56cdaf41.js"><link rel="prefetch" href="/assets/js/30.8b95a1f1.js"><link rel="prefetch" href="/assets/js/31.c91ff346.js"><link rel="prefetch" href="/assets/js/32.b98ca641.js"><link rel="prefetch" href="/assets/js/33.d0d05ad0.js"><link rel="prefetch" href="/assets/js/34.4c521488.js"><link rel="prefetch" href="/assets/js/35.b804bcd7.js"><link rel="prefetch" href="/assets/js/36.5c07cfef.js"><link rel="prefetch" href="/assets/js/37.a0565011.js"><link rel="prefetch" href="/assets/js/38.b8ae16d0.js"><link rel="prefetch" href="/assets/js/39.ac23927e.js"><link rel="prefetch" href="/assets/js/4.b9abaf2a.js"><link rel="prefetch" href="/assets/js/40.51f0a3f5.js"><link rel="prefetch" href="/assets/js/41.c1a8242a.js"><link rel="prefetch" href="/assets/js/42.749efe23.js"><link rel="prefetch" href="/assets/js/43.624833c8.js"><link rel="prefetch" href="/assets/js/44.bbddd63e.js"><link rel="prefetch" href="/assets/js/45.d8d15651.js"><link rel="prefetch" href="/assets/js/46.1e480f1b.js"><link rel="prefetch" href="/assets/js/47.4f1075d4.js"><link rel="prefetch" href="/assets/js/48.a8f6c2ba.js"><link rel="prefetch" href="/assets/js/49.106d8698.js"><link rel="prefetch" href="/assets/js/5.1c0b46f4.js"><link rel="prefetch" href="/assets/js/50.a0819973.js"><link rel="prefetch" href="/assets/js/51.cb93eaba.js"><link rel="prefetch" href="/assets/js/52.69fe7f19.js"><link rel="prefetch" href="/assets/js/53.ad8f6842.js"><link rel="prefetch" href="/assets/js/54.c25909c5.js"><link rel="prefetch" href="/assets/js/55.833154c7.js"><link rel="prefetch" href="/assets/js/56.75e06106.js"><link rel="prefetch" href="/assets/js/57.f5b5d514.js"><link rel="prefetch" href="/assets/js/58.574fd406.js"><link rel="prefetch" href="/assets/js/59.d07a17b6.js"><link rel="prefetch" href="/assets/js/6.4b4de84d.js"><link rel="prefetch" href="/assets/js/60.ee946b2f.js"><link rel="prefetch" href="/assets/js/61.68581797.js"><link rel="prefetch" href="/assets/js/62.99d168fd.js"><link rel="prefetch" href="/assets/js/63.14c4cfa2.js"><link rel="prefetch" href="/assets/js/64.61b2d608.js"><link rel="prefetch" href="/assets/js/65.f7077be9.js"><link rel="prefetch" href="/assets/js/66.0ce2a0ec.js"><link rel="prefetch" href="/assets/js/67.ee0094b6.js"><link rel="prefetch" href="/assets/js/68.c61d0f9f.js"><link rel="prefetch" href="/assets/js/69.c59f3168.js"><link rel="prefetch" href="/assets/js/7.ea2aa07c.js"><link rel="prefetch" href="/assets/js/70.21ea68bf.js"><link rel="prefetch" href="/assets/js/71.11355b09.js"><link rel="prefetch" href="/assets/js/72.cdc4bc45.js"><link rel="prefetch" href="/assets/js/73.d8946aed.js"><link rel="prefetch" href="/assets/js/74.75a2fd5c.js"><link rel="prefetch" href="/assets/js/75.14d3ef7d.js"><link rel="prefetch" href="/assets/js/76.3f73a91e.js"><link rel="prefetch" href="/assets/js/77.0018ed7f.js"><link rel="prefetch" href="/assets/js/78.c471326e.js"><link rel="prefetch" href="/assets/js/79.f9a1e6f0.js"><link rel="prefetch" href="/assets/js/8.f25633c9.js"><link rel="prefetch" href="/assets/js/80.a8c296e0.js"><link rel="prefetch" href="/assets/js/81.f6451a8b.js"><link rel="prefetch" href="/assets/js/82.f7393e31.js"><link rel="prefetch" href="/assets/js/83.a0642cbd.js"><link rel="prefetch" href="/assets/js/84.f2c12c65.js"><link rel="prefetch" href="/assets/js/85.f0077176.js"><link rel="prefetch" href="/assets/js/86.4180d39a.js"><link rel="prefetch" href="/assets/js/87.04e4ab18.js"><link rel="prefetch" href="/assets/js/88.93ea241c.js"><link rel="prefetch" href="/assets/js/89.555a3ba8.js"><link rel="prefetch" href="/assets/js/9.9aae1341.js"><link rel="prefetch" href="/assets/js/90.0701a493.js"><link rel="prefetch" href="/assets/js/91.8347eb90.js"><link rel="prefetch" href="/assets/js/92.9320e5ec.js"><link rel="prefetch" href="/assets/js/93.87dec14c.js"><link rel="prefetch" href="/assets/js/94.7a4ce357.js"><link rel="prefetch" href="/assets/js/95.060612ac.js"><link rel="prefetch" href="/assets/js/97.5572d4ae.js"><link rel="prefetch" href="/assets/js/98.e013c8af.js"><link rel="prefetch" href="/assets/js/99.867ed389.js">
    <link rel="stylesheet" href="/assets/css/0.styles.29dce6f0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo_no_words.png" alt="郭必扬的写字楼" class="logo"> <span class="site-name can-hide">郭必扬的写字楼</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/dl_basis/" class="nav-link">
  深度学习笔记
</a></div><div class="nav-item"><a href="/nlp_basis/" class="nav-link">
  NLP笔记
</a></div><div class="nav-item"><a href="/paper_notes/" class="nav-link router-link-active">
  吃点儿论文
</a></div><div class="nav-item"><a href="/engineering/" class="nav-link">
  工程
</a></div><div class="nav-item"><a href="/opinions/" class="nav-link">
  随笔
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  Me
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在别处~" class="dropdown-title"><span class="title">在别处~</span> <span class="arrow down"></span></button> <button type="button" aria-label="在别处~" class="mobile-dropdown-title"><span class="title">在别处~</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/beyondguo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/v35g-p7wK2MkuM-SqjkF3g" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微信公众号「SimpleAI」
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.zhihu.com/people/guo-bi-yang-78" target="_blank" rel="noopener noreferrer" class="nav-link external">
  知乎「蝈蝈」
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/f4fe92da869c" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/dl_basis/" class="nav-link">
  深度学习笔记
</a></div><div class="nav-item"><a href="/nlp_basis/" class="nav-link">
  NLP笔记
</a></div><div class="nav-item"><a href="/paper_notes/" class="nav-link router-link-active">
  吃点儿论文
</a></div><div class="nav-item"><a href="/engineering/" class="nav-link">
  工程
</a></div><div class="nav-item"><a href="/opinions/" class="nav-link">
  随笔
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  Me
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="在别处~" class="dropdown-title"><span class="title">在别处~</span> <span class="arrow down"></span></button> <button type="button" aria-label="在别处~" class="mobile-dropdown-title"><span class="title">在别处~</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/beyondguo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://mp.weixin.qq.com/s/v35g-p7wK2MkuM-SqjkF3g" target="_blank" rel="noopener noreferrer" class="nav-link external">
  微信公众号「SimpleAI」
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.zhihu.com/people/guo-bi-yang-78" target="_blank" rel="noopener noreferrer" class="nav-link external">
  知乎「蝈蝈」
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.jianshu.com/u/f4fe92da869c" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>图嵌入之node2vec（KDD-2016）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/paper_notes/notes/%E5%9B%BE%E5%B5%8C%E5%85%A5%E4%B9%8Bnode2vec%EF%BC%88KDD-2016%EF%BC%89.html#传统的特征表示方法" class="sidebar-link">传统的特征表示方法：</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/paper_notes/notes/%E5%9B%BE%E5%B5%8C%E5%85%A5%E4%B9%8Bnode2vec%EF%BC%88KDD-2016%EF%BC%89.html#新的思路-本文方法" class="sidebar-link">新的思路 &amp; 本文方法</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/paper_notes/notes/%E5%9B%BE%E5%B5%8C%E5%85%A5%E4%B9%8Bnode2vec%EF%BC%88KDD-2016%EF%BC%89.html#如何生成node-sequence" class="sidebar-link">如何生成node sequence</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/paper_notes/notes/%E5%9B%BE%E5%B5%8C%E5%85%A5%E4%B9%8Bnode2vec%EF%BC%88KDD-2016%EF%BC%89.html#如何学习节点特征" class="sidebar-link">如何学习节点特征</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/paper_notes/notes/%E5%9B%BE%E5%B5%8C%E5%85%A5%E4%B9%8Bnode2vec%EF%BC%88KDD-2016%EF%BC%89.html#如何表示边的特征" class="sidebar-link">如何表示边的特征</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/paper_notes/notes/%E5%9B%BE%E5%B5%8C%E5%85%A5%E4%B9%8Bnode2vec%EF%BC%88KDD-2016%EF%BC%89.html#案例和实验" class="sidebar-link">案例和实验：</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="图嵌入之node2vec-kdd-2016"><a href="#图嵌入之node2vec-kdd-2016" class="header-anchor">#</a> 图嵌入之node2vec（KDD-2016）</h1> <blockquote><p>最近图相关的理论很火热啊，耳边一直听到各种graph embedding，什么GNN、GCN，结果发现自己对这方面完全不了解，赶紧找几篇论文来读一读。今天这一篇就是大家不管听没听说但总觉得眼熟的node2vec。不用想，这个node2vec一定跟word2vec有血缘关系，所以熟悉word2vec的同学应该可以很快了解node2vec的思想。</p></blockquote> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618565835-image.png" alt=""></p> <p>不同于图像、自然语言这种欧式空间的数据，网络结构的数据——图，通常无法通过CNN或者RNN来处理，这就需要我们寻找其他的方法来处理图数据。图数据其实非常常见，例如社交网络关系、分子结构、论文互相引用的关系网络等等，所以如何表达网络节点的特征就十分重要，表达好了节点的特征，我们就可以用它做下游的分类、预测、聚类、可视化等等任务。</p> <h2 id="传统的特征表示方法"><a href="#传统的特征表示方法" class="header-anchor">#</a> 传统的特征表示方法：</h2> <h4 id="_1-特征工程"><a href="#_1-特征工程" class="header-anchor">#</a> 1. 特征工程</h4> <p>这个是机器学习最苦最累最关键的活儿，之前处理图数据，需要请专家人工定义网络节点的特征，这里面涉及很多图论的知识和领域知识，所以特征工程十分麻烦。
虽然这种特征工程最后往往可以（在花费巨大人力物力之后）取得比较好的效果，但一个明显的问题是——<strong>泛化性能差</strong>！因为特征工程往往是针对特定任务的，你换一个任务，也许之前的特征就不管用了。</p> <h4 id="_2-在任务中学特征"><a href="#_2-在任务中学特征" class="header-anchor">#</a> 2.在任务中学特征</h4> <p>前面不是嫌累嫌麻烦嘛，那咱们就不自己定义特征，定义一个下游任务，把这些特征作为参数，喂大量数据让它自己去学！显而易见，你是省事儿了，机器可不省事儿。成千上万个节点、随便就上百的维度，轻轻松松让你增加几千万训练参数，这个<strong>计算开销可大</strong>了。而且，这还是有监督的方法，意味着依然在不同任务间的<strong>泛化性能较差</strong>。</p> <h4 id="_3-隐模型法-降维-矩阵分解法"><a href="#_3-隐模型法-降维-矩阵分解法" class="header-anchor">#</a> 3.隐模型法/降维/矩阵分解法</h4> <p>这一类方法不知道怎么叫才好，总的思想跟推荐系统中<strong>矩阵分解法</strong>十分类似，属于<strong>无监督学习</strong>。试着把原来的网络结构表达成一个巨大的系数矩阵，然后通过Factorization来得到隐表示，作为各个节点的表示向量。这一类方法主要的问题在于<strong>计算开销大</strong>，尤其是对于真实世界中的大型网络，搞一个矩阵分解也不是什么容易事儿。另外，实证表明这样的表示在很多预测任务上效果较差。</p> <h2 id="新的思路-本文方法"><a href="#新的思路-本文方法" class="header-anchor">#</a> 新的思路 &amp; 本文方法</h2> <p>上面列举了传统的方法的各种问题。那么可以怎么设计一种新的思路来得到节点的表示呢？
作者们想到了那大名鼎鼎的词向量——<strong>word2vec</strong>。词向量方法<strong>使用无监督的方法从大量的无标注文本中学得词语的分布式表示，不仅蕴含了大量的信息，而且可以迁移到各种下游任务中</strong>。
对于网络数据能否使用同样的方法呢？
<strong>网络中存在很多很多通路，将各个节点连成一条线，这些连线蕴含着节点之间的相互关系，就如同句子中各个词语的关系一样</strong>。因此，我们可以自然地想到——把这些节点序列当做句子，用word2vec的方法进行训练，就可以得到node的向量表示了！</p> <p>这里的关键问题在于——<strong>如何生成node序列</strong>。这也是本文的重点。</p> <h2 id="如何生成node-sequence"><a href="#如何生成node-sequence" class="header-anchor">#</a> 如何生成node sequence</h2> <p>这里给出一个论文中的图来辅助说明：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618595943-image.png" alt=""></p> <p>这个图中，可以看到有<strong>两个明显的小团体</strong>，分别以<strong>u</strong>和<strong>s6</strong>为中心。如果这就是一个简单的社交网络关系的话，可以猜测u和s1,s2,s3,s4也许是<strong>同班同学</strong>这样的关系，同样s6和s5,s7,s8,s9也是类似的关系，但二者不是同一个班。然后u和s6也许是两个班的<strong>班长</strong>。</p> <p>那么这个里面就有些意思了，我们在生成节点序列的时候，要有什么规则？
首先，我们要知道，节点放到一个序列中了，就说明你认为它们在某种意义上是相似的。
你既可以认为<strong>u跟s1,s2,s3,s4它们是相似的</strong>，它们是网络中<strong>直接的邻居</strong>，这时称为<strong>homophily</strong>；
<strong>也可以认为u应该跟s6更相似</strong>，这种称为<strong>结构相似</strong>，<strong>structural equivalence</strong>。</p> <p>要想从一个节点去寻找它的直接邻居，就要通过<strong>BFS（广度优先搜索）</strong>，而如果想找到那些结构相似的，我们就不能在邻居那里转圈圈的，就需要“走出去”，因此就需要通过<strong>DFS（深度优先搜索）</strong>。图中给出了两种方法的示意。</p> <h4 id="node2vec使用的方法-biased-random-walk"><a href="#node2vec使用的方法-biased-random-walk" class="header-anchor">#</a> node2vec使用的方法——biased random walk</h4> <p>在网络的表示中，homophily和structural equivalence都十分重要，我们<strong>希望可以在生成序列的时候同时考虑这两种相似性。</strong>
并且，我们希望可以有参数让我们控制二者的一个偏重，这样在不同的任务我们可以灵活地调整。</p> <p>看下图：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618608811-image.png" alt=""></p> <p>假设我们<strong>从t节点开始</strong>了一个<strong>random walk</strong>，现在<strong>到达了v节点</strong>。
现在的问题是<strong>下一步怎么走</strong>？</p> <p>如果采取BFS策略的话，应该走到x1，因为v和x1都是t节点的直接邻居；如果采取DFS策略的话，应该走向x2或者x3，因为它们和t都中间隔了一步；当然，也可能又返回到了t节点。</p> <p>于是作者设计了一个<strong>二阶</strong>转移概率算法：
两个节点之间的<strong>转移概率</strong>为：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618625372-image.png" alt=""></p> <p>其中，w为两节点的边的weight，这个根据场景而设定。α为search bias，定义为：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618638165-image.png" alt=""></p> <blockquote><p><strong>一个节点的下一步怎么走，取决于它的上一步和下一步的关系。</strong></p></blockquote> <p>有点拗口，我们逐一解释一下：
<strong>v是当前的节点，t是v的上一步所在节点，而x代表下一步的位置。</strong> <strong>d(t,x)代表t和x之间的最短距离：</strong></p> <ul><li>当d=0时，就是从v又回到t节点的意思，这个时候search bias为1/p，可以理解为以1/p的概率<strong>返回上一步</strong>；</li> <li>当d=1时，则<strong>x为t的直接邻居</strong>，相当于BFS，这时的bias为1；</li> <li>当d=2时，则<strong>x是t邻居的邻居</strong>，相当于DFS，这时的bias为1/q；</li></ul> <p>作者称<strong>p为Return parameter</strong>，因为p控制着回到原节点的概率；成<strong>q为In-out parameter</strong>，因为它控制着BFS和DFS的关系。</p> <p>这样，我们设置不同的p和q，就可以得到不一样偏重的node sequence。在训练模型的时候，可以使用grid search来寻找最优的p和q。也可以根据场景的需要来选择p和q。</p> <h2 id="如何学习节点特征"><a href="#如何学习节点特征" class="header-anchor">#</a> 如何学习节点特征</h2> <p>这里就是完全借用<strong>word2vec</strong>的方法。
总的目标函数是：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618650714-image.png" alt=""></p> <p>这里的f就是把节点u映射到特征空间的函数，N(u)是通过前面node sequence得到的u的近邻节点，相当于词向量训练中的上下文。
下面是具体如何计算：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618660552-image.png" alt=""></p> <p>这一部分不想多讲，了解词向量的话这里十分好理解。
<strong>关于词向量，可以在我的专栏中找到相关的文章。</strong></p> <p>这样，我们就可以总结一个<strong>node2vec完整的算法框架</strong>了：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618676254-image.png" alt=""></p> <h2 id="如何表示边的特征"><a href="#如何表示边的特征" class="header-anchor">#</a> 如何表示边的特征</h2> <p>上面已经学习到了各个节点（node）的特征，但是<strong>很多任务中我们是针对边（edge）的，因此我们也需要边的特征。</strong>
实际上，<strong>一条边不就是由两个节点决定</strong>的吗，因此可以用两个节点的特征来表示，作者给出了一些选项：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618693234-image.png" alt=""></p> <h2 id="案例和实验"><a href="#案例和实验" class="header-anchor">#</a> 案例和实验：</h2> <h4 id="_1-可视化"><a href="#_1-可视化" class="header-anchor">#</a> 1. 可视化</h4> <p>作者首先在一个人物关系网络上试了试node2vec，通过<strong>kmeans聚类，并做了一个可视化</strong>，看看node2vec得到的节点向量可以反映出网络的什么特点：
当作者设置<strong>p=1,q=0.5</strong>的时候，聚类的效果是这样的：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618708073-image.png" alt=""></p> <p>可见这个时候各个<strong>小社区、小团体被聚为一类</strong>。</p> <p>当作者设置<strong>p=1,q=2</strong>的时候，聚类效果是这样的：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618727519-image.png" alt=""></p> <p>这个时候，可以发现各个社区之间的桥梁——蓝色节点，被聚成一类，因为它们有<strong>类似的结构特点</strong>，而那些淡黄色的点，是那些人物关系中比较边缘化的那些人。</p> <p>所以可以看到，不同的p和q确实使node2vec刻画一个网络在不同方面的特点。</p> <h4 id="_2-节点分类-node-classification"><a href="#_2-节点分类-node-classification" class="header-anchor">#</a> 2. 节点分类（node classification）</h4> <p>这里先把使用的测试数据集和用于对比的模型列一下，由于比较好理解，我就不翻译了：</p> <p>数据集：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618754056-image.png" alt=""></p> <p>对比模型：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618765144-image.png" alt=""></p> <p>实验结果：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618773971-image.png" alt=""></p> <h4 id="_3-连接预测-link-prediction"><a href="#_3-连接预测-link-prediction" class="header-anchor">#</a> 3.连接预测（link prediction）</h4> <p>对于link，我们就需要构造边的特征的，具体构造方法上面也给出了。这里也是直接贴实验结果了：</p> <p><img src="https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/2021-6-25/1624618796437-image.png" alt=""></p> <p>a，b，c，d分别代表四种edge feature生成的方法。</p> <hr> <p>这些就大致是node2vec的内容，更多细节还是参见论文吧。
另外，斯坦福提供了现成的代码和训练方法，可以参见他们的官网：
http://snap.stanford.edu/node2vec/</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.41fc4255.js" defer></script><script src="/assets/js/2.a266bdc2.js" defer></script><script src="/assets/js/96.0b640400.js" defer></script>
  </body>
</html>
