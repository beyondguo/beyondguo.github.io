(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{464:function(s,t,a){"use strict";a.r(t);var i=a(44),l=Object(i.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"小样本学习与triplet-loss-数据增强和课程学习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小样本学习与triplet-loss-数据增强和课程学习"}},[s._v("#")]),s._v(" 小样本学习与Triplet Loss，数据增强和课程学习")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/beyond_guo/typora_pics/raw/master/typora/20220210230114.png",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("标题：Few-Shot Text Classification with Triplet Networks, Data Augmentation, and Curriculum Learning.")]),s._v(" "),a("li",[s._v("会议：NAACL-21 (short paper)")]),s._v(" "),a("li",[s._v("链接：https://readpaper.com/paper/3139506831")])]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("一句话总结：")]),s._v("\n一个简洁明了的short-paper，没啥技术含量，主要贡献在于设计了使用数据增强的课程学习方式，并验证了在few-shot分类问题上的有效性。")])]),s._v(" "),a("h2",{attrs:{id:"课程学习式数据增强-curriculum-data-augmentation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#课程学习式数据增强-curriculum-data-augmentation"}},[s._v("#")]),s._v(" 课程学习式数据增强（curriculum data augmentation）")]),s._v(" "),a("p",[s._v("这应该就是本文最主要的贡献了。作者"),a("strong",[s._v("使用文本增强时文本的改动幅度来衡量增强样本的难度，从而设计课程学习策略")]),s._v("。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/beyond_guo/typora_pics/raw/master/typora/20220210233643.png",alt:"curriculum data augmentation"}}),s._v("\n具体分为两种方法：")]),s._v(" "),a("p",[a("strong",[s._v("① 两阶段法（two-stage）")])]),s._v(" "),a("p",[s._v("先使用原样本进行训练，然后把增强样本混进来训练。这里的增强样本使用都是同样的改动幅度，所以该方法就是分了两个层级的难度。")]),s._v(" "),a("p",[a("strong",[s._v("②渐进式（gradual）")])]),s._v(" "),a("p",[s._v("设定一个难度范围，从最低难度开始训练，收敛后就增大难度继续训练，直到训练到最大难度。")]),s._v(" "),a("p",[s._v("具体设置就是这段话：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/beyond_guo/typora_pics/raw/master/typora/20220210234352.png",alt:"课程学习的具体设置"}})]),s._v(" "),a("p",[s._v("然后就可以直接看实验结果了：")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://gitee.com/beyond_guo/typora_pics/raw/master/typora/20220210234611.png",alt:"实验结果"}}),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/beyond_guo/typora_pics/raw/master/typora/20220210234752.png",alt:"更详细的实验"}})]),s._v(" "),a("p",[s._v("总之就是，使用课程学习的思路来进行数据增强，确实会比传统的数据增强训练方式有效，这也是为什么two-stage的方式会更好。而那个gradual的方式，相当于设置了更多的课程阶梯，使用了更多的增强样本，所以效果肯定会好一些。")]),s._v(" "),a("h2",{attrs:{id:"小样本学习和triplet-loss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小样本学习和triplet-loss"}},[s._v("#")]),s._v(" "),a("strong",[s._v("小样本学习和Triplet loss")])]),s._v(" "),a("p",[s._v("这里再单独讲一讲few-shot learning和Triplet loss，因为一开始我是从数据增强角度去找到这篇文章的，加上之前对few-shot learning也不太了解，所以搞不懂为什么一定要跟triplet loss扯上关系。")]),s._v(" "),a("p",[s._v("我们回顾上面贴第二个实验结果表，它揭示了Triplet loss在few-shot任务中相比于使用cross-entropy loss的优势。")]),s._v(" "),a("p",[s._v("这个triple loss最开始是用于训练人脸识别模型的，因为人脸识别就是要识别的人一般非常多（类别多），但是我们能够提供给模型拿来训练的人脸样本非常少（few-shot），所以在这种背景下，triple loss就被设计出来，把一个分类问题，转化成相似度问题，使用少量的训练样本，训练出一个相似函数，然后在预测时，就可以计算新样本跟训练集中已有的样本的相似度，从而判断类别。")]),s._v(" "),a("p",[s._v("计算Triplet Loss使用的是一批三元组(A,P,N)，计算公式是这样的：")]),s._v(" "),a("p",[a("span",{staticClass:"katex-display"},[a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[a("semantics",[a("mrow",[a("mi",[s._v("L")]),a("mo",[s._v("=")]),a("munder",[a("mo",[s._v("∑")]),a("mi",[s._v("i")])],1),a("mi",[s._v("m")]),a("mi",[s._v("a")]),a("mi",[s._v("x")]),a("mo",{attrs:{stretchy:"false"}},[s._v("(")]),a("mi",[s._v("d")]),a("mo",{attrs:{stretchy:"false"}},[s._v("(")]),a("msub",[a("mi",[s._v("A")]),a("mi",[s._v("i")])],1),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msub",[a("mi",[s._v("P")]),a("mi",[s._v("i")])],1),a("mo",{attrs:{stretchy:"false"}},[s._v(")")]),a("mo",[s._v("−")]),a("mi",[s._v("d")]),a("mo",{attrs:{stretchy:"false"}},[s._v("(")]),a("msub",[a("mi",[s._v("A")]),a("mi",[s._v("i")])],1),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("msub",[a("mi",[s._v("N")]),a("mi",[s._v("i")])],1),a("mo",{attrs:{stretchy:"false"}},[s._v(")")]),a("mo",[s._v("+")]),a("mi",[s._v("α")]),a("mo",{attrs:{separator:"true"}},[s._v(",")]),a("mn",[s._v("0")]),a("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("L = \\sum_i max(d(A_i,P_i)-d(A_i,N_i)+\\alpha,0)\n")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.68333em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathnormal"},[s._v("L")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),a("span",{staticClass:"mrel"},[s._v("=")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"2.327674em","vertical-align":"-1.277669em"}}),a("span",{staticClass:"mop op-limits"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.0500050000000003em"}},[a("span",{staticStyle:{top:"-1.872331em","margin-left":"0em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.05em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])]),a("span",{staticStyle:{top:"-3.050005em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"3.05em"}}),a("span",[a("span",{staticClass:"mop op-symbol large-op"},[s._v("∑")])])])]),a("span",{staticClass:"vlist-s"},[s._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"1.277669em"}},[a("span")])])])]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord mathnormal"},[s._v("ma")]),a("span",{staticClass:"mord mathnormal"},[s._v("x")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord mathnormal"},[s._v("d")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathnormal"},[s._v("A")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.31166399999999994em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])])]),a("span",{staticClass:"vlist-s"},[s._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[a("span")])])])])]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.13889em"}},[s._v("P")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.31166399999999994em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.13889em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])])]),a("span",{staticClass:"vlist-s"},[s._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[a("span")])])])])]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[s._v("−")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathnormal"},[s._v("d")]),a("span",{staticClass:"mopen"},[s._v("(")]),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathnormal"},[s._v("A")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.31166399999999994em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"0em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])])]),a("span",{staticClass:"vlist-s"},[s._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[a("span")])])])])]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord"},[a("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),a("span",{staticClass:"msupsub"},[a("span",{staticClass:"vlist-t vlist-t2"},[a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.31166399999999994em"}},[a("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.10903em","margin-right":"0.05em"}},[a("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),a("span",{staticClass:"sizing reset-size6 size3 mtight"},[a("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])])]),a("span",{staticClass:"vlist-s"},[s._v("​")])]),a("span",{staticClass:"vlist-r"},[a("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[a("span")])])])])]),a("span",{staticClass:"mclose"},[s._v(")")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),a("span",{staticClass:"mbin"},[s._v("+")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}})]),a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),a("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.0037em"}},[s._v("α")]),a("span",{staticClass:"mpunct"},[s._v(",")]),a("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),a("span",{staticClass:"mord"},[s._v("0")]),a("span",{staticClass:"mclose"},[s._v(")")])])])])])]),s._v(" "),a("p",[s._v("其中，A代表anchor样本，P代表positive样本，N代表negative样本，"),a("span",{staticClass:"katex"},[a("span",{staticClass:"katex-mathml"},[a("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[a("semantics",[a("mrow",[a("mi",[s._v("α")])],1),a("annotation",{attrs:{encoding:"application/x-tex"}},[s._v("\\alpha")])],1)],1)],1),a("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[a("span",{staticClass:"base"},[a("span",{staticClass:"strut",staticStyle:{height:"0.43056em","vertical-align":"0em"}}),a("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.0037em"}},[s._v("α")])])])]),s._v("则是一个用于缓冲的距离，或者说margin，d则是一个计算距离的函数，可以使用余弦距离或者欧氏距离。")]),s._v(" "),a("p",[s._v("借用B站Shusen Wang老师的教程（链接：https://www.bilibili.com/video/BV1vQ4y1R7dr?t=511.5）中的示意图来帮助理解：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/beyond_guo/typora_pics/raw/master/typora/20220211113744.png",alt:"来源B站Shusen Wang老师的教程，链接：https://www.bilibili.com/video/BV1vQ4y1R7dr?t=511.5"}})]),s._v(" "),a("p",[s._v("在训练样本很少的情况下，这种基于相似度的方法可以更加细致地刻画不同类别之间的区别，所以可以取得比cross-entropy更好的效果。")]),s._v(" "),a("h3",{attrs:{id:"triplet-loss-vs-cross-entropy-loss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#triplet-loss-vs-cross-entropy-loss"}},[s._v("#")]),s._v(" "),a("strong",[s._v("triplet loss VS. cross-entropy loss")])]),s._v(" "),a("p",[s._v("这里我们不禁要问，那triplet loss和cross-entropy loss各自的适用场景是什么呢？")]),s._v(" "),a("p",[a("strong",[s._v("triplet loss，一般用于相似度、检索和小样本分类任务")]),s._v("上，而一般的分类任务，则更常使用cross-entropy。")]),s._v(" "),a("p",[s._v("虽然triplet loss我们看起来可以使同类别的样本的表示更近、不同类别的表示更远，在这一点上似乎比cross-entropy loss更优一些，但实际上"),a("strong",[s._v("由于每次计算triplet loss都只是考虑了两个类别，还涉及到正负样本的采样问题，所以triplet loss计算存在不稳定、收敛慢的问题")]),s._v("，而cross-entropy则是计算时会考虑所有类别，所以在普通分类问题上效果会更好。")]),s._v(" "),a("p",[s._v("更多关于二者的对比，可以参见下面链接：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("知乎讨论：https://www.zhihu.com/question/402067053/answer/1297490623")])]),s._v(" "),a("li",[a("p",[s._v("为什么triplet loss有效？http://bindog.github.io/blog/2019/10/23/why-triplet-loss-works/")])])])])}),[],!1,null,null,null);t.default=l.exports}}]);